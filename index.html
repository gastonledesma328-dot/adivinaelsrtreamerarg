<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Wordle Streamers Argentinos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #8B5CF6;
            --secondary-color: #EC4899;
            --correct-color: #10B981;
            --present-color: #F59E0B;
            --absent-color: #64748B;
            --text-color: #0f172a;
            --card-bg: rgba(30, 41, 59, 0.12);
            --key-bg: rgba(71, 85, 105, 0.5);
            --letter-box-bg: rgba(255, 255, 255, 0.35);
            --letter-box-border: rgba(15, 23, 42, 0.25);
            --spacing-unit: 8px;
            --border-radius: 12px;
            --section-gap: calc(var(--spacing-unit) * 3);
            --cell-size: 48px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #5086c1, #6a9eda, #84b6f4, #b2dafa, #dcffff);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-color);
            padding: var(--section-gap);
            background-attachment: fixed;
        }

        /* =========== SPLASH INICIAL FULLSCREEN =========== */
        #splash {
            position: fixed;
            inset: 0;
            z-index: 9999;
            display: grid;
            place-items: center;
            background: linear-gradient(135deg, #5086c1, #6a9eda, #84b6f4, #b2dafa, #dcffff);
            transition: opacity .6s ease, visibility .6s ease;
        }
        #splash.hide { opacity: 0; visibility: hidden; }

        .splash-content {
            width: min(920px, 92vw);
            max-height: 90vh;
            overflow: auto;
            padding: 28px 24px;
            border-radius: 16px;
            backdrop-filter: blur(8px);
            background: rgba(255, 255, 255, 0.35);
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        }

        .title-grid { display: flex; flex-direction: column; align-items: center; gap: 10px; margin-bottom: 24px; }
        .word-row { display: flex; justify-content: center; gap: 6px; flex-wrap: wrap; }
        .splash-letter {
            width: 48px; height: 48px;
            display: flex; align-items: center; justify-content: center;
            font-weight: 800; font-size: 20px; color: #fff;
            border-radius: 6px;
        }
        .s-grey  { background-color: #787c7e; } /* ADIVINA + EL */
        .s-green { background-color: #6aaa64; } /* STREAMER */

        .rules { text-align: left; margin-bottom: 18px; color: #1f2937; line-height: 1.6; }
        .rules p { margin-bottom: 12px; }

        .color-explanation { display: flex; align-items: center; margin: 10px 0; }
        .color-box {
            width: 32px; height: 32px; border-radius: 6px; margin-right: 12px;
            display: flex; align-items: center; justify-content: center;
            font-weight: 800; color: #fff; font-size: 14px;
        }

        .bottom-section { text-align: center; margin-top: 10px; }
        .emoji { font-size: 18px; margin-right: 8px; }

        .play-button {
            background: #6aaa64; color: white; border: none;
            padding: 12px 22px; border-radius: 999px; font-size: 16px; font-weight: 800;
            cursor: pointer; transition: transform .15s ease, background-color .25s ease;
        }
        .play-button:hover { background: #5a9a54; transform: scale(1.04); }
        /* =========== FIN SPLASH INICIAL =========== */

        /* =========== SPLASH DE VICTORIA FULLSCREEN =========== */
        #winSplash {
            position: fixed;
            inset: 0;
            z-index: 9998;
            display: grid;
            place-items: center;
            background: rgba(15, 23, 42, 0.92);
            color: #fff;
            visibility: hidden;
            opacity: 0;
            transition: opacity .4s ease, visibility .4s ease;
        }
        #winSplash.show { visibility: visible; opacity: 1; }

        .win-card {
            width: min(520px, 92vw);
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 16px;
            padding: 22px 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
        }
        .win-title{ font-size: 1.8rem; margin-bottom: 10px; color: #10B981; }
        .win-name { font-weight: 800; font-size: 1.3rem; letter-spacing: .5px; }
        .win-img {
            width: 90px; height: 90px; border-radius: 50%; object-fit: cover;
            border: 2px solid #fff; margin: 12px auto;
        }
        .win-actions { display: flex; gap: 10px; justify-content: center; margin-top: 8px; flex-wrap: wrap; }
        .btn {
            padding: 10px 16px; border: none; border-radius: 10px; cursor: pointer; font-weight: 800;
        }
        .btn-primary { background: #10B981; color: #fff; }
        .btn-secondary { background: rgba(255,255,255,0.15); color: #fff; }
        /* =========== FIN SPLASH VICTORIA =========== */

        .container {
            max-width: 500px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--section-gap);
        }

        .header { width: 100%; text-align: center; margin-bottom: var(--spacing-unit); }
        .title {
            font-size: 2rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.08);
            background: linear-gradient(to right, #0f172a, #1e293b);
            -webkit-background-clip: text; background-clip: text; color: transparent;
            margin-bottom: var(--spacing-unit);
        }
        .subtitle { font-size: 1rem; opacity: 0.9; }

        .game-info {
            display: flex; justify-content: space-between; align-items: center;
            width: 100%; margin-bottom: var(--spacing-unit);
        }
        .game-mode {
            background: var(--card-bg);
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 2);
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
            display: flex; align-items: center; gap: var(--spacing-unit);
        }
        .timer { font-size: 0.9rem; opacity: 0.9; display: flex; align-items: center; gap: var(--spacing-unit); }

        .difficulty-selector {
            display: flex; gap: calc(var(--spacing-unit) * 2);
            margin-bottom: var(--section-gap);
            justify-content: center; width: 100%;
        }
        .difficulty-btn {
            padding: var(--spacing-unit) calc(var(--spacing-unit) * 2);
            border-radius: var(--border-radius);
            background: var(--card-bg);
            border: none; color: var(--text-color); cursor: pointer;
            transition: all 0.3s ease; font-size: 0.9rem;
        }
        .difficulty-btn.active { background: var(--primary-color); color: #fff; font-weight: bold; }

        .hint {
            background: var(--card-bg);
            padding: calc(var(--spacing-unit) * 2);
            border-radius: var(--border-radius);
            width: 100%; backdrop-filter: blur(10px);
        }
        .hint-title {
            font-weight: bold; margin-bottom: var(--spacing-unit);
            color: #1e293b; display: flex; align-items: center; gap: var(--spacing-unit);
        }
        .hint-text { font-size: 0.95rem; opacity: 0.95; line-height: 1.5; text-align: center; }

        /* TABLERO: altura se ajusta por JS */
        .game-board {
            display: grid;
            grid-template-rows: repeat(6, auto);
            gap: var(--spacing-unit);
            width: 100%;
            margin: var(--spacing-unit) 0;
        }
        .guess-row {
            display: grid;
            gap: var(--spacing-unit);
            grid-template-columns: repeat(var(--word-length, 8), var(--cell-size)); /* fallback */
            justify-content: center;
        }

        /* CASILLA de letra */
        .letter-box {
            width: var(--cell-size);
            height: var(--cell-size);
            border: 2px solid var(--letter-box-border);
            border-radius: var(--border-radius);
            display: flex; align-items: center; justify-content: center;
            font-size: calc(var(--cell-size) * 0.5);
            font-weight: bold; text-transform: uppercase;
            background: var(--letter-box-bg); backdrop-filter: blur(10px);
            transition: all 0.3s ease; color: #0f172a;
        }
        /* CELDA de ESPACIO (invisible) */
        .space-cell { width: var(--cell-size); height: var(--cell-size); background: transparent; border: none; pointer-events: none; }

        .letter-box.correct { background: var(--correct-color); border-color: var(--correct-color); color: #fff; animation: flip 0.6s ease; }
        .letter-box.present { background: var(--present-color); border-color: var(--present-color); color: #fff; animation: flip 0.6s ease; }
        .letter-box.absent  { background: var(--absent-color);  border-color: var(--absent-color);  color: #fff; animation: flip 0.6s ease; }
        .letter-box.filled  { border-color: rgba(15,23,42,0.5); animation: pulse 0.2s ease; }

        .keyboard { display: grid; gap: var(--spacing-unit); margin-bottom: var(--section-gap); width: 100%; }
        .keyboard-row { display: flex; gap: var(--spacing-unit); justify-content: center; width: 100%; }

        .key {
            padding: calc(var(--spacing-unit) * 2) var(--spacing-unit);
            background: var(--key-bg); border: none;
            border-radius: calc(var(--border-radius) / 2);
            color: #0f172a; font-weight: bold; cursor: pointer;
            min-width: 30px; height: 50px; display: flex; align-items: center; justify-content: center;
            font-size: 1rem;
        }
        .key.enter, .key.backspace { min-width: 60px; font-size: 0.8rem; }
        .key.enter    { background: var(--primary-color); color: #fff; }
        .key.backspace{ background: #EF4444; color: #fff; }

        .stats-container {
            display: grid; grid-template-columns: repeat(2, 1fr);
            gap: calc(var(--spacing-unit) * 2); margin-bottom: var(--section-gap); width: 100%;
        }
        .stat { background: var(--card-bg); padding: calc(var(--spacing-unit) * 2); border-radius: var(--border-radius); backdrop-filter: blur(10px); text-align: center; }
        .stat-number { font-size: 1.5rem; font-weight: bold; display: block; }
        .stat-label { font-size: 0.8rem; opacity: 0.9; }

        .actions {
            display: flex; gap: calc(var(--spacing-unit) * 2);
            margin-bottom: var(--section-gap); justify-content: center; width: 100%; flex-wrap: wrap;
        }
        .btn-wide { min-width: 150px; }
        .btn-primary { background: var(--primary-color); color: #fff; }
        .btn-secondary { background: var(--card-bg); color: #0f172a; border: none; border-radius: var(--border-radius); padding: calc(var(--spacing-unit) * 2) calc(var(--spacing-unit) * 3); font-weight: bold; cursor: pointer; }

        @keyframes flip { 0%{transform:rotateX(0)} 50%{transform:rotateX(90deg)} 100%{transform:rotateX(0)} }
        @keyframes pulse{ 0%{transform:scale(1)} 50%{transform:scale(1.05)} 100%{transform:scale(1)} }

        @media (max-width: 480px) {
            .splash-content { padding: 20px 16px; }
            .splash-letter { width: 44px; height: 44px; font-size: 18px; }
            .letter-box { font-size: calc(var(--cell-size) * 0.48); }
            .key { height: 45px; min-width: 25px; font-size: 0.9rem; }
            .key.enter, .key.backspace { min-width: 50px; font-size: 0.7rem; }
            .actions { flex-direction: column; align-items: center; }
            .btn-wide { width: 100%; }
        }
    </style>
</head>
<body>
    <!-- SPLASH INICIAL -->
    <div id="splash" aria-live="polite">
        <div class="splash-content">
            <div class="title-grid">
                <div class="word-row">
                    <div class="splash-letter s-grey">A</div>
                    <div class="splash-letter s-grey">D</div>
                    <div class="splash-letter s-grey">I</div>
                    <div class="splash-letter s-grey">V</div>
                    <div class="splash-letter s-grey">I</div>
                    <div class="splash-letter s-grey">N</div>
                    <div class="splash-letter s-grey">A</div>
                </div>
                <div class="word-row">
                    <div class="splash-letter s-grey">E</div>
                    <div class="splash-letter s-grey">L</div>
                </div>
                <div class="word-row">
                    <div class="splash-letter s-green">S</div>
                    <div class="splash-letter s-green">T</div>
                    <div class="splash-letter s-green">R</div>
                    <div class="splash-letter s-green">E</div>
                    <div class="splash-letter s-green">A</div>
                    <div class="splash-letter s-green">M</div>
                    <div class="splash-letter s-green">E</div>
                    <div class="splash-letter s-green">R</div>
                </div>
            </div>

            <div class="rules">
                <p>Las reglas son simples: adivina el streamer oculto en 6 intentos. Cada intento debe ser un nombre válido y si el streamer no existe el juego te avisará.</p>
                <p>Después de cada intento el color de las casillas cambia para mostrar qué tan cerca estás de acertar el streamer:</p>
                <div class="color-explanation">
                    <div class="color-box" style="background:#10B981;">M</div>
                    <div><strong>VERDE</strong> significa que la letra está en el nombre y en la posición CORRECTA.</div>
                </div>
                <div class="color-explanation">
                    <div class="color-box" style="background:#F59E0B;">A</div>
                    <div><strong>AMARILLO</strong> significa que la letra está presente en el nombre pero en la posición INCORRECTA.</div>
                </div>
                <div class="color-explanation">
                    <div class="color-box" style="background:#64748B;">R</div>
                    <div><strong>GRIS</strong> significa que la letra NO está presente en el nombre.</div>
                </div>
            </div>

            <div class="bottom-section">
                <p><span class="emoji">🎮</span>¡Un streamer nuevo cada día!</p>
                <button class="play-button" id="startGame">¡Jugar!</button>
            </div>
        </div>
    </div>

    <!-- SPLASH DE VICTORIA -->
    <div id="winSplash" role="dialog" aria-modal="true" aria-labelledby="winTitle">
        <div class="win-card">
            <h2 id="winTitle" class="win-title">🎉 ¡Correcto! 🎉</h2>
            <img id="winImg" class="win-img" src="" alt="Streamer">
            <div id="winName" class="win-name">Streamer</div>
            <div class="win-actions">
                <button id="playAgain" class="btn btn-primary">Jugar otra vez</button>
                <button id="closeWin" class="btn btn-secondary">Cerrar</button>
            </div>
        </div>
    </div>

    <div class="container" aria-hidden="false">
        <div class="header">
            <h1 class="title">ADIVINA EL STREAMER ARG</h1>
            <p class="subtitle">Adivina el streamer argentino en 6 intentos</p>
        </div>

        <div class="game-info">
            <div class="game-mode">
                <i class="fas fa-gamepad"></i>
                <span id="gameMode">Normal</span>
            </div>
            <div class="timer">
                <i class="fas fa-clock"></i>
                <span id="gameTimer">00:00</span>
            </div>
        </div>

        <div class="difficulty-selector">
            <button class="difficulty-btn active" data-difficulty="normal">Normal</button>
            <button class="difficulty-btn" data-difficulty="hard">Difícil</button>
            <button class="difficulty-btn" data-difficulty="extreme">Extremo</button>
        </div>

        <div class="hint" id="hint">
            <div class="hint-title">
                <i class="fas fa-lightbulb"></i>
                <span>Pista:</span>
                <button class="btn-secondary btn-wide" style="padding: 6px 10px; margin-left: auto;" id="hintToggle" aria-label="Mostrar u ocultar pista">
                    <i class="fas fa-eye"></i>
                </button>
            </div>
            <div class="hint-text" id="hintText">El rey de Kick Argentina, fundador de la Coscu Army</div>
        </div>

        <div class="game-board" id="gameBoard"></div>

        <!-- (Quitado el cuadro de mensaje permanente) -->

        <div class="keyboard" id="keyboard">
            <div class="keyboard-row">
                <button class="key" data-key="q">Q</button>
                <button class="key" data-key="w">W</button>
                <button class="key" data-key="e">E</button>
                <button class="key" data-key="r">R</button>
                <button class="key" data-key="t">T</button>
                <button class="key" data-key="y">Y</button>
                <button class="key" data-key="u">U</button>
                <button class="key" data-key="i">I</button>
                <button class="key" data-key="o">O</button>
                <button class="key" data-key="p">P</button>
            </div>
            <div class="keyboard-row">
                <button class="key" data-key="a">A</button>
                <button class="key" data-key="s">S</button>
                <button class="key" data-key="d">D</button>
                <button class="key" data-key="f">F</button>
                <button class="key" data-key="g">G</button>
                <button class="key" data-key="h">H</button>
                <button class="key" data-key="j">J</button>
                <button class="key" data-key="k">K</button>
                <button class="key" data-key="l">L</button>
                <button class="key" data-key="ñ">Ñ</button>
            </div>
            <div class="keyboard-row">
                <button class="key enter" data-key="enter"><i class="fas fa-arrow-right"></i></button>
                <button class="key" data-key="z">Z</button>
                <button class="key" data-key="x">X</button>
                <button class="key" data-key="c">C</button>
                <button class="key" data-key="v">V</button>
                <button class="key" data-key="b">B</button>
                <button class="key" data-key="n">N</button>
                <button class="key" data-key="m">M</button>
                <button class="key backspace" data-key="backspace"><i class="fas fa-backspace"></i></button>
            </div>
        </div>

        <div class="stats-container">
            <div class="stat">
                <span class="stat-number" id="gamesPlayed">0</span>
                <span class="stat-label">Jugados</span>
            </div>
            <div class="stat">
                <span class="stat-number" id="winPercentage">0%</span>
                <span class="stat-label">Victorias</span>
            </div>
            <div class="stat">
                <span class="stat-number" id="currentStreak">0</span>
                <span class="stat-label">Racha Actual</span>
            </div>
            <div class="stat">
                <span class="stat-number" id="maxStreak">0</span>
                <span class="stat-label">Mejor Racha</span>
            </div>
        </div>

        <div class="actions">
            <button class="btn-secondary btn-wide" onclick="newGame()">
                <i class="fas fa-redo"></i>&nbsp; NUEVO JUEGO
            </button>
            <button class="btn-secondary btn-wide" id="howToPlayBtn">
                <i class="fas fa-question-circle"></i>&nbsp; CÓMO JUGAR
            </button>
            <button class="btn-secondary btn-wide" id="streamersBtn">
                <i class="fas fa-users"></i>&nbsp; STREAMERS
            </button>
        </div>
    </div>

    <script>
    // =======================
    // SPLASH INICIAL
    // =======================
    function startTimerFromZero() {
        if (window.timerInterval) clearInterval(timerInterval);
        const gameTimer = document.getElementById('gameTimer');
        gameTimer.textContent = '00:00';
        startTime = new Date();
        timerInterval = setInterval(updateTimer, 1000);
    }

    function hideSplash() {
        const splash = document.getElementById('splash');
        if (!splash.classList.contains('hide')) {
            splash.classList.add('hide');
            startTimerFromZero();
        }
    }

    window.addEventListener('load', () => {
        document.getElementById('startGame').addEventListener('click', hideSplash);
    });

    // =======================
    // DB de streamers
    // =======================
    const STREAMERS_DB = [
        { name: "AGUSBOB", hint: "🇦🇷 Streamer de Slots", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ8Z5_kV4T12lw1j4kYUra8rNlA5Yiu_3W1jA&s" },
        { name: "ALONSO", hint: "🇦🇷 Streamer hermano de Tomás Mazza", image: "https://imagenes.montevideo.com.uy/imgnoticias/202507/_W933_80/924825.jpg" },
        { name: "BANANIROU", hint: "🇦🇷 Streamer de gaming y variedad (pelado)", image: "https://i.ytimg.com/vi/hI1EG7KjDqI/hq720.jpg?sqp=-oaymwEhCK4FEIIDSFryq4qpAxMIARUAAAAAGAElAADIQj0AgKJD&rs=AOn4CLDBG7yJdgs7Gh6uNLJyeHLVGE8o4A" },
        { name: "BRUNENGER", hint: "🇦🇷 Conocido por su humor e IRL", image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTQ_wP3zOTGfQHWUoB9p3j53g6__g2twlcYag&s" },
        { name: "CARRERAAA", hint: "🇦🇷 Reacciones épicas", image: "" },
        { name: "COKER", hint: "🇦🇷 Just Chatting", image: "" },
        { name: "COSCU", hint: "🇦🇷 Rey de Kick Argentina, Coscu Army", image: "" },
        { name: "FRANKKASTER", hint: "🇦🇷 Veterano argentino", image: "" },
        { name: "IAARAS", hint: "🇦🇷 Gaming y variedad", image: "" },
        { name: "JOACO TURRO", hint: "🇦🇷 Personalidad única", image: "" },
        { name: "KING", hint: "🇦🇷 Gaming/Entretenimiento", image: "" },
        { name: "LA AGUSNETA", hint: "🇦🇷 Fútbol, parecido a Mr. Bean", image: "" },
        { name: "LA COBRAA", hint: "🇦🇷 Fútbol", image: "" },
        { name: "LILCAKE", hint: "🇦🇷 Música", image: "" },
        { name: "LOLO", hint: "🇦🇷 Variedad", image: "" },
        { name: "LUQUITA RODRIGUEZ", hint: "🇦🇷 Humor", image: "" },
        { name: "MEICA", hint: "🇦🇷 Gaming", image: "" },
        { name: "OKY", hint: "🇦🇷 IRL/Just Chatting", image: "" },
        { name: "ROD SQUARE", hint: "🇦🇷 Gaming y variedad", image: "" },
        { name: "SANTUTU", hint: "🇦🇷 Slots", image: "" },
        { name: "SPREEN", hint: "🇦🇷 Súper popular", image: "" },
        { name: "TOMAS MAZZA", hint: "🇦🇷 IRL, hermano de Alonso", image: "" },
        { name: "ZEKO", hint: "🇦🇷 Competitivo", image: "" },
        { name: "ROBLEIS", hint: "🇦🇷 Gaming y variedad", image: "" },
        { name: "MARTIN CIRIO", hint: "🇦🇷 Just Chatting", image: "" },
        { name: "LOKONAZO", hint: "🇦🇷 Gaming/Chatting", image: "" }
    ];

    // =======================
    // Estado del juego
    // =======================
    let currentWord = '';      // con espacios
    let evalWord = '';         // sin espacios
    let letterPositions = [];  // columnas visibles de letras
    let currentHint = '';
    let currentImage = '';
    let currentGuess = '';     // sin espacios
    let guesses = [];
    let currentRow = 0;
    let gameOver = false;
    let currentDifficulty = 'normal';
    let startTime = null;
    let timerInterval = null;
    let stats = JSON.parse(localStorage.getItem('wordleStreamersStats')) || {
        gamesPlayed: 0,
        gamesWon: 0,
        currentStreak: 0,
        maxStreak: 0,
        guessDistribution: [0, 0, 0, 0, 0, 0],
        lastPlayed: null
    };

    // =======================
    // Elementos DOM
    // =======================
    const gameBoard = document.getElementById('gameBoard');
    const hintText = document.getElementById('hintText');
    const gameMode = document.getElementById('gameMode');
    const gameTimer = document.getElementById('gameTimer');

    // =======================
    // Dificultad por longitud
    // =======================
    function lengthDifficulty(nameWithSpaces) {
        const len = nameWithSpaces.replace(/\s+/g, '').length;
        if (len <= 6) return 'normal';
        if (len <= 9) return 'hard';
        return 'extreme';
    }
    function candidatesByDifficulty(diff) {
        return STREAMERS_DB.filter(s => lengthDifficulty(s.name) === diff);
    }
    function setDifficulty(diff) {
        currentDifficulty = diff;
        document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
        const btn = document.querySelector(`.difficulty-btn[data-difficulty="${diff === 'hard' ? 'hard' : diff}"]`);
        if (btn) btn.classList.add('active');
        gameMode.textContent = diff === 'hard' ? 'Difícil' : (diff.charAt(0).toUpperCase() + diff.slice(1));
        newGame();
    }

    // =======================
    // Inicializar juego
    // =======================
    function initGame() {
        updateStats();
        newGame();
        setupEventListeners();
        setTimeout(adjustLayout, 50);
    }

    function newGame() {
        if (timerInterval) clearInterval(timerInterval);
        gameTimer.textContent = '00:00';

        const diffKey = currentDifficulty === 'dificil' ? 'hard' : currentDifficulty;
        let pool = candidatesByDifficulty(diffKey);
        if (pool.length === 0) pool = [...STREAMERS_DB];

        const streamer = pool[Math.floor(Math.random() * pool.length)];

        currentWord = streamer.name.toUpperCase();       // con espacios
        evalWord    = currentWord.replace(/\s+/g, '');   // sin espacios
        currentHint = streamer.hint;
        currentImage = streamer.image || '';

        currentGuess = '';
        guesses = [];
        currentRow = 0;
        gameOver = false;

        // el tiempo arranca cuando cierra el splash inicial
        startTime = null;

        hintText.textContent = currentHint;
        gameMode.textContent = diffKey === 'hard' ? 'Difícil' : (diffKey.charAt(0).toUpperCase() + diffKey.slice(1));

        document.querySelectorAll('.key').forEach(key => key.classList.remove('correct','present','absent'));

        createGameBoard();
        adjustLayout();

        // cerrar splash de victoria si estaba abierto
        document.getElementById('winSplash').classList.remove('show');
    }

    // =======================
    // Tablero con espacios invisibles
    // =======================
    function createGameBoard() {
        gameBoard.innerHTML = '';
        letterPositions = [];
        const displayLength = currentWord.length;
        gameBoard.style.setProperty('--word-length', displayLength);

        for (let i = 0; i < 6; i++) {
            const row = document.createElement('div');
            row.className = 'guess-row';
            row.style.gridTemplateColumns = `repeat(${displayLength}, var(--cell-size))`;

            for (let j = 0; j < displayLength; j++) {
                const ch = currentWord[j];
                if (ch === ' ') {
                    const gap = document.createElement('div');
                    gap.className = 'space-cell';
                    gap.id = `space-${i}-${j}`;
                    row.appendChild(gap);
                } else {
                    const box = document.createElement('div');
                    box.className = 'letter-box';
                    box.id = `box-${i}-${j}`;
                    row.appendChild(box);
                    if (i === 0) letterPositions.push(j);
                }
            }
            gameBoard.appendChild(row);
        }
    }

    function updateCurrentRow() {
        for (const col of letterPositions) {
            const box = document.getElementById(`box-${currentRow}-${col}`);
            box.textContent = '';
            box.classList.remove('filled');
        }
        for (let i = 0; i < currentGuess.length; i++) {
            const col = letterPositions[i];
            const box = document.getElementById(`box-${currentRow}-${col}`);
            const letter = currentGuess[i] || '';
            box.textContent = letter;
            box.classList.toggle('filled', letter !== '');
        }
    }

    function updateTimer() {
        if (!startTime) return;
        const now = new Date();
        const diff = Math.floor((now - startTime) / 1000);
        const minutes = Math.floor(diff / 60).toString().padStart(2, '0');
        const seconds = (diff % 60).toString().padStart(2, '0');
        document.getElementById('gameTimer').textContent = `${minutes}:${seconds}`;
    }

    function setupEventListeners() {
        document.addEventListener('keydown', (e) => {
            if (gameOver) return;
            const key = e.key.toLowerCase();
            if (key === 'enter') {
                e.preventDefault();
                handleKeyPress('enter');
            } else if (key === 'backspace' || key === 'delete') {
                handleKeyPress('backspace');
            } else if (key.match(/^[a-zñ]$/i)) {
                handleKeyPress(key);
            }
        });

        document.getElementById('keyboard').addEventListener('click', (e) => {
            const target = e.target.closest('.key');
            if (!target) return;
            handleKeyPress(target.dataset.key);
        });

        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const diffAttr = btn.dataset.difficulty;
                setDifficulty(diffAttr);
            });
        });

        document.getElementById('hintToggle').addEventListener('click', (e) => {
            e.stopPropagation();
            const text = document.getElementById('hintText');
            const btn = document.getElementById('hintToggle');
            const hidden = text.style.display === 'none';
            text.style.display = hidden ? 'block' : 'none';
            btn.innerHTML = hidden ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
            adjustLayout();
        });

        document.getElementById('howToPlayBtn').addEventListener('click', () => {
            alert("Cómo jugar:\n\n1. Adivina el streamer argentino en 6 intentos.\n2. Verdes: letra y posición correctas.\n3. Amarillas: letra correcta, posición incorrecta.\n4. Grises: letra no está.\n\nLos espacios no se adivinan.");
        });

        document.getElementById('streamersBtn').addEventListener('click', () => {
            alert("Posibles streamers:\n\n" + STREAMERS_DB.map(s => s.name).join(", "));
        });

        window.addEventListener('resize', adjustLayout);

        // acciones del splash de victoria
        document.getElementById('playAgain').addEventListener('click', () => {
            newGame();
        });
        document.getElementById('closeWin').addEventListener('click', () => {
            document.getElementById('winSplash').classList.remove('show');
        });
    }

    // =======================
    // Input / validación
    // =======================
    function handleKeyPress(key) {
        if (gameOver) return;

        if (key === 'enter') {
            if (currentGuess.length === evalWord.length) {
                submitGuess();
            } else {
                // sin cuadro de mensaje: feedback mínimo
                // (opcional) vibración ligera si está en móvil
                if (navigator.vibrate) navigator.vibrate(50);
            }
        } else if (key === 'backspace') {
            if (currentGuess.length > 0) {
                currentGuess = currentGuess.slice(0, -1);
                updateCurrentRow();
            }
        } else if (/^[a-zñ]$/i.test(key) && currentGuess.length < evalWord.length) {
            currentGuess += key.toUpperCase();
            updateCurrentRow();
        }
    }

    // =======================
    // Evaluación
    // =======================
    function submitGuess() {
        const guess = currentGuess; // sin espacios
        guesses.push(guess);

        const result = checkGuess(guess, evalWord); // por letra
        animateGuess(result);
        updateKeyboard(guess, result);

        if (guess === evalWord) {
            setTimeout(() => {
                gameOver = true;
                stats.gamesWon++;
                stats.currentStreak++;
                stats.maxStreak = Math.max(stats.maxStreak, stats.currentStreak);
                stats.gamesPlayed++;
                stats.guessDistribution[currentRow]++;
                stats.lastPlayed = new Date().toDateString();
                saveStats();
                updateStats();
                showWinSplash();
            }, 600);
        } else if (currentRow === 5) {
            setTimeout(() => {
                gameOver = true;
                stats.currentStreak = 0;
                stats.gamesPlayed++;
                stats.lastPlayed = new Date().toDateString();
                saveStats();
                updateStats();
                // (opcional) mostrar una alerta de derrota
                alert("💔 ¡Game Over!\nLa respuesta era: " + currentWord);
            }, 600);
        } else {
            currentRow++;
            currentGuess = '';
        }
    }

    function showWinSplash() {
        const win = document.getElementById('winSplash');
        const winName = document.getElementById('winName');
        const winImg = document.getElementById('winImg');

        winName.textContent = currentWord;
        if (currentImage) {
            winImg.src = currentImage;
            winImg.style.display = 'block';
            winImg.onerror = () => winImg.style.display = 'none';
        } else {
            winImg.style.display = 'none';
        }
        win.classList.add('show');
    }

    function checkGuess(guessNoSpace, wordNoSpace) {
        const result = new Array(wordNoSpace.length).fill('absent');
        const wordArr = wordNoSpace.split('');
        const guessArr = guessNoSpace.split('');

        // Correctas primero
        for (let i = 0; i < guessArr.length; i++) {
            if (guessArr[i] === wordArr[i]) {
                result[i] = 'correct';
                wordArr[i] = null;
                guessArr[i] = null;
            }
        }
        // Presentes
        for (let i = 0; i < guessArr.length; i++) {
            if (guessArr[i] !== null) {
                const idx = wordArr.indexOf(guessArr[i]);
                if (idx !== -1) {
                    result[i] = 'present';
                    wordArr[idx] = null;
                }
            }
        }
        return result;
    }

    function animateGuess(result) {
        for (let i = 0; i < result.length; i++) {
            const col = letterPositions[i];
            const box = document.getElementById(`box-${currentRow}-${col}`);
            setTimeout(() => { box.classList.add(result[i]); }, i * 100);
        }
    }

    function updateKeyboard(guessNoSpace, result) {
        for (let i = 0; i < guessNoSpace.length; i++) {
            const letter = guessNoSpace[i].toLowerCase();
            const key = document.querySelector(`[data-key="${letter}"]`);
            const status = result[i];
            if (key && !key.classList.contains('correct')) {
                if (status === 'correct') {
                    key.classList.remove('present', 'absent');
                    key.classList.add('correct');
                } else if (status === 'present' && !key.classList.contains('correct')) {
                    key.classList.remove('absent');
                    key.classList.add('present');
                } else if (status === 'absent' && !key.classList.contains('correct') && !key.classList.contains('present')) {
                    key.classList.add('absent');
                }
            }
        }
    }

    function updateStats() {
        document.getElementById('gamesPlayed').textContent = stats.gamesPlayed;
        document.getElementById('winPercentage').textContent =
            stats.gamesPlayed > 0 ? `${Math.round((stats.gamesWon / stats.gamesPlayed) * 100)}%` : '0%';
        document.getElementById('currentStreak').textContent = stats.currentStreak;
        document.getElementById('maxStreak').textContent = stats.maxStreak;
    }
    function saveStats() {
        localStorage.setItem('wordleStreamersStats', JSON.stringify(stats));
    }

    // =======================
    // Layout responsive del tablero
    // =======================
    function adjustLayout() {
        const rootStyles = getComputedStyle(document.documentElement);
        const gap = parseFloat(rootStyles.getPropertyValue('--spacing-unit')) || 8;

        const hint = document.getElementById('hint');
        const container = document.querySelector('.container');

        // área disponible aproximada para el board entre la pista y el teclado
        const containerRect = container.getBoundingClientRect();
        const hintRect = hint.getBoundingClientRect();
        const keyboardEl = document.getElementById('keyboard');
        const keyboardRect = keyboardEl.getBoundingClientRect();

        // espacio entre el final de la pista y el inicio del teclado, menos márgenes
        let availableH = (keyboardRect.top - hintRect.bottom) - 3 * gap;
        if (availableH < 160) availableH = 160;

        const displayCols = currentWord.length; // incluye espacios
        const rows = 6;
        const boardInnerW = gameBoard.clientWidth - (displayCols - 1) * gap;
        const boardInnerH = availableH - (rows - 1) * gap;

        let cellSize = Math.floor(Math.min(boardInnerW / displayCols, boardInnerH / rows));
        cellSize = Math.max(28, Math.min(cellSize, 72));

        document.documentElement.style.setProperty('--cell-size', `${cellSize}px`);
        const totalBoardH = cellSize * rows + gap * (rows - 1);
        gameBoard.style.height = `${totalBoardH}px`;

        document.querySelectorAll('.letter-box').forEach(box => {
            box.style.fontSize = `${Math.max(16, Math.floor(cellSize * 0.5))}px`;
        });

        document.querySelectorAll('.guess-row').forEach(row => {
            row.style.gridTemplateColumns = `repeat(${displayCols}, var(--cell-size))`;
        });
    }

    // Iniciar
    window.onload = initGame;
    </script>
</body>
</html>
